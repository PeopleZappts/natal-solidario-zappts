<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Natal Solid√°rio Zappts 2025</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes twinkle {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }
    .star {
      animation: twinkle 3s infinite;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    class NatalSolidario {
      constructor() {
        this.cartas = [];
        this.senhaRelatorio = '@People123';

        // CONFIG SUPABASE
        this.supabaseUrl = 'https://qykyaafhqaatlefozrvq.supabase.co';
        this.supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF5a3lhYWZocWFhdGxlZm96cnZxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQyMjEwNzMsImV4cCI6MjA3OTc5NzA3M30.Ik6O0Lm0nsYLkyXAhLQaA7qicTXhLDD4X1Bj_2Fav4Q';
        this.bucket = 'cartinhas';

        this.carregarCartas();
      }

      // ---------- SUPABASE REST ----------
      async db(path, options = {}) {
        const res = await fetch(`${this.supabaseUrl}/rest/v1${path}`, {
          ...options,
          headers: {
            apikey: this.supabaseKey,
            Authorization: `Bearer ${this.supabaseKey}`,
            ...(options.headers || {})
          }
        });

        if (!res.ok) {
          const txt = await res.text();
          console.error('Erro Supabase DB:', txt);
          throw new Error(txt);
        }

        if (res.status === 204) return null;
        return res.json();
      }

      async uploadImagem(file) {
        const nomeArquivo = `${Date.now()}-${file.name}`;
        const urlUpload = `${this.supabaseUrl}/storage/v1/object/${this.bucket}/${encodeURIComponent(nomeArquivo)}`;

        const res = await fetch(urlUpload, {
          method: 'POST',
          headers: {
            apikey: this.supabaseKey,
            Authorization: `Bearer ${this.supabaseKey}`,
            'Content-Type': file.type
          },
          body: file
        });

        if (!res.ok) {
          const txt = await res.text();
          console.error('Erro upload imagem:', txt);
          throw new Error(txt);
        }

        const publicUrl = `${this.supabaseUrl}/storage/v1/object/public/${this.bucket}/${encodeURIComponent(nomeArquivo)}`;
        return publicUrl;
      }

      // ---------- CARREGAR CARTAS ----------
      async carregarCartas() {
        try {
          const dados = await this.db('/cartas?select=*');

          this.cartas = (dados || []).map(row => ({
            id: row.id,
            nome: row.nome,
            idade: row.idade,
            desejo: row.desejo,
            imagem: row.imagem,
            escolhidosPor: row.escolhidos_por || []
          }));
        } catch (error) {
          console.error('Erro ao carregar cartas:', error);
          this.cartas = [];
        }

        this.renderizar();
      }

      // ---------- VALIDAR EMAIL ----------
      validarEmail(email) {
        return email.endsWith('@zappts.com.br');
      }

      // ---------- ADICIONAR CARTA ----------
      async adicionarCarta(nome, idade, desejo, arquivoImagem) {
        try {
          let imagemUrl = null;

          if (arquivoImagem) {
            imagemUrl = await this.uploadImagem(arquivoImagem);
          }

          const corpo = {
            nome: nome.trim(),
            idade: idade.trim(),
            desejo: (desejo || '').trim() || 'Brinquedo a escolher',
            imagem: imagemUrl,
            escolhidos_por: []
          };

          const dados = await this.db('/cartas', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              Prefer: 'return=representation'
            },
            body: JSON.stringify(corpo)
          });

          const salva = dados[0];

          this.cartas.push({
            id: salva.id,
            nome: salva.nome,
            idade: salva.idade,
            desejo: salva.desejo,
            imagem: salva.imagem,
            escolhidosPor: salva.escolhidos_por || []
          });

          this.renderizar();
          return true;
        } catch (error) {
          console.error('Erro ao adicionar cartinha:', error);
          alert('Erro ao adicionar cartinha. Veja o console.');
          return false;
        }
      }

      // ---------- ESCOLHER CARTA ----------
      async escolherCarta(cartaId, email) {
        const carta = this.cartas.find(c => c.id === cartaId);
        if (!carta) return false;

        // se j√° tiver esse e-mail na cartinha, ignora
        if (carta.escolhidosPor.includes(email)) return true;

        const novaLista = [...carta.escolhidosPor, email];

        try {
          await this.db(`/cartas?id=eq.${cartaId}`, {
            method: 'PATCH',
            headers: {
              'Content-Type': 'application/json',
              Prefer: 'return=minimal'
            },
            body: JSON.stringify({ escolhidos_por: novaLista })
          });

          carta.escolhidosPor = novaLista;
          this.renderizar();
          return true;
        } catch (error) {
          console.error('Erro ao registrar escolha:', error);
          alert('Erro ao registrar escolha. Veja o console.');
          return false;
        }
      }

      // ---------- REMOVER ESCOLHA ----------
      async removerEscolha(cartaId, email) {
        const carta = this.cartas.find(c => c.id === cartaId);
        if (!carta) return;

        const novaLista = carta.escolhidosPor.filter(e => e !== email);

        try {
          await this.db(`/cartas?id=eq.${cartaId}`, {
            method: 'PATCH',
            headers: {
              'Content-Type': 'application/json',
              Prefer: 'return=minimal'
            },
            body: JSON.stringify({ escolhidos_por: novaLista })
          });

          carta.escolhidosPor = novaLista;
          this.renderizar();
        } catch (error) {
          console.error('Erro ao remover escolha:', error);
          alert('Erro ao remover escolha. Veja o console.');
        }
      }

      // ---------- DELETAR CARTA ----------
      deletarCarta(cartaId) {
        this.cartaIdParaDeletar = cartaId;
        this.abrirModalSenhaDelete();
      }

      async confirmarDelete() {
        const senha = document.getElementById('senhaDelete').value;
        const erroDiv = document.getElementById('erroSenhaDelete');

        if (senha !== this.senhaRelatorio) {
          erroDiv.classList.remove('hidden');
          return;
        }

        try {
          await this.db(`/cartas?id=eq.${this.cartaIdParaDeletar}`, {
            method: 'DELETE'
          });

          this.cartas = this.cartas.filter(c => c.id !== this.cartaIdParaDeletar);
          document.getElementById('modais').innerHTML = '';
          this.renderizar();
        } catch (error) {
          console.error('Erro ao deletar cartinha:', error);
          alert('Erro ao excluir cartinha. Veja o console.');
        }
      }

      // ---------- RELAT√ìRIO ----------
      baixarRelatorio(senha) {
        if (senha !== this.senhaRelatorio) return false;

        let conteudo = 'N¬∫ Cartinha,Nome,Idade,Desejo,Zappters que Escolheram,Total de Escolhas\n';

        this.cartas.forEach((carta, index) => {
          const emails = carta.escolhidosPor.join('; ');
          const total = carta.escolhidosPor.length;
          conteudo += `${index + 1},"${carta.nome}",${carta.idade},"${carta.desejo}","${emails}",${total}\n`;
        });

        const blob = new Blob([conteudo], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);

        link.setAttribute('href', url);
        link.setAttribute('download', `natal-solidario-relatorio-${new Date().toLocaleDateString()}.csv`);
        link.style.visibility = 'hidden';

        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        return true;
      }

      // ---------- RENDER ----------
      renderizar() {
        const app = document.getElementById('app');

        app.innerHTML = `
          <div class="min-h-screen p-8" style="background: linear-gradient(135deg, #0c1e3a 0%, #1a2f5a 50%, #0d1929 100%); background-attachment: fixed;">
            <!-- Estrelas -->
            <div class="absolute inset-0 pointer-events-none overflow-hidden">
              ${Array.from({ length: 100 }, () => `
                <div class="star absolute rounded-full bg-white" style="
                  width: ${Math.random() * 2}px;
                  height: ${Math.random() * 2}px;
                  left: ${Math.random() * 100}%;
                  top: ${Math.random() * 100}%;
                  opacity: 0.7;
                "></div>
              `).join('')}
            </div>

            <div class="max-w-7xl mx-auto relative z-10">
              <!-- Cabe√ßalho -->
              <div class="text-center mb-12">
                <div class="flex items-center justify-center gap-6 mb-6">
                  <img src="logo-zappts.png" alt="Zappts" class="h-14 md:h-16 object-contain" />
                  <img src="bot-natal.png" alt="Bot Zappts" class="h-16 md:h-20 object-contain" />
                </div>
                <h1 class="text-5xl md:text-7xl font-black text-white mb-8 drop-shadow-2xl" style="font-family: Arial, sans-serif; letter-spacing: 0.02em;">
                  üéÑ Natal Solid√°rio 2025 üéÑ
                </h1>
                <p class="text-2xl md:text-3xl text-white mb-8 font-black drop-shadow-lg" style="font-family: Arial, sans-serif;">
                  Escolha uma cartinha e realize um sonho de Natal!
                </p>
                
                <div class="inline-block bg-cyan-500 bg-opacity-30 backdrop-blur px-8 py-4 rounded-xl border-2 border-cyan-400">
                  <p class="text-white font-bold text-lg">
                    ‚ú® ${this.cartas.length} cartinhas ‚Ä¢ ${this.cartas.reduce((s, c) => s + c.escolhidosPor.length, 0)} escolhas realizadas
                  </p>
                </div>
              </div>

              <!-- Bot√µes -->
              <div class="flex justify-center gap-4 mb-8 flex-wrap">
                <button onclick="app.abrirModalSenhaAdmin()" class="bg-cyan-400 hover:bg-cyan-300 text-blue-900 font-bold py-3 px-8 rounded-xl flex items-center gap-2 transition shadow-xl text-lg">
                  ‚ûï Adicionar Nova Cartinha
                </button>
                <button onclick="app.abrirModalInfo()" class="bg-white hover:bg-gray-100 text-blue-700 font-bold py-3 px-8 rounded-xl flex items-center gap-2 transition shadow-xl text-lg">
                  ‚ÑπÔ∏è Saiba Mais
                </button>
                <button onclick="app.abrirModalSenha()" ${this.cartas.length === 0 ? 'disabled' : ''} class="bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-bold py-3 px-8 rounded-xl flex items-center gap-2 transition shadow-xl text-lg">
                  üìä Baixar Relat√≥rio
                </button>
              </div>

              <!-- Grid de Cartas -->
              <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mb-12">
                ${
                  this.cartas.length > 0
                    ? this.cartas.map((c, i) => `
                      <div class="relative rounded-xl overflow-hidden shadow-xl hover:shadow-2xl transition">
                        <div class="p-4 rounded-xl bg-gradient-to-br from-emerald-300 to-emerald-400 h-64 flex flex-col justify-between hover:scale-105 transition-transform cursor-pointer" onclick="app.abrirModalEscolha(${c.id})">
                          <div class="flex justify-between items-start">
                            <span class="inline-block bg-blue-700 text-white px-2 py-1 rounded-full text-xs font-black">#${i + 1}</span>
                            <button onclick="event.stopPropagation(); app.deletarCarta(${c.id})" class="text-blue-800 hover:text-blue-950 bg-white rounded-full p-1 shadow-lg">‚úï</button>
                          </div>
                          <div class="text-center flex-1 flex items-center justify-center">
                            ${
                              c.imagem
                                ? `<img src="${c.imagem}" class="w-20 h-20 object-cover rounded-lg cursor-pointer" onclick="event.stopPropagation(); app.ampliarImagem('${c.imagem}')">`
                                : '<p class="text-5xl">üòä</p>'
                            }
                          </div>
                          <div class="text-center">
                            <p class="font-black text-blue-900 text-sm">${c.nome}</p>
                            <p class="text-xs text-blue-800 font-semibold">${c.idade} anos</p>
                            <p class="text-xs text-blue-700 mt-1 italic font-semibold">${c.desejo}</p>
                          </div>
                          <div class="text-center">
                            <p class="text-xs font-black bg-blue-700 text-white py-1 px-2 rounded-lg">
                              üë• ${c.escolhidosPor.length} ${c.escolhidosPor.length === 1 ? 'escolheu' : 'escolheram'}
                            </p>
                          </div>
                        </div>
                      </div>
                    `).join('')
                    : '<div class="col-span-full text-center py-20 text-white text-2xl font-bold">Nenhuma cartinha adicionada ainda! üéÑ</div>'
                }
              </div>

              <!-- Resumo de Escolhas -->
              ${
                this.cartas.some(c => c.escolhidosPor.length > 0)
                  ? `
                  <div class="bg-white bg-opacity-95 rounded-xl p-6 shadow-2xl border-2 border-cyan-400">
                    <h2 class="text-3xl font-black text-blue-700 mb-4">üìã Escolhas Realizadas</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                      ${
                        this.cartas
                          .filter(c => c.escolhidosPor.length > 0)
                          .map(c => `
                            <div class="bg-gradient-to-br from-cyan-50 to-blue-50 p-4 rounded-lg border-2 border-cyan-400">
                              <p class="font-black text-blue-700 mb-2">Cartinha #${this.cartas.indexOf(c) + 1}</p>
                              <p class="text-gray-800 font-bold">${c.nome}, ${c.idade} anos</p>
                              <p class="text-sm text-gray-600 mb-3 font-semibold">Desejo: ${c.desejo}</p>
                              <div class="space-y-1">
                                <p class="text-xs font-bold text-blue-700">Escolhido por:</p>
                                ${
                                  c.escolhidosPor.map(email => `
                                    <div class="flex justify-between items-center bg-white p-2 rounded border border-cyan-300">
                                      <span class="text-sm text-gray-700 font-semibold">üë§ ${email}</span>
                                      <button onclick="app.removerEscolha(${c.id}, '${email}')" class="text-blue-600 hover:text-blue-800 font-bold">‚úï</button>
                                    </div>
                                  `).join('')
                                }
                              </div>
                            </div>
                          `).join('')
                      }
                    </div>
                  </div>
                `
                  : ''
              }
            </div>

            <!-- Modais -->
            <div id="modais"></div>
          </div>
        `;

        window.app = this;
      }

      // ---------- MODAL SENHA ADMIN (ANTES DE NOVA CARTA) ----------
      abrirModalSenhaAdmin() {
        const modaisDiv = document.getElementById('modais');
        modaisDiv.innerHTML = `
          <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full shadow-2xl border-2 border-cyan-400">
              <h2 class="text-2xl font-black text-blue-700 mb-4">üîí Acesso para adicionar cartinha</h2>
              <p class="text-gray-700 mb-6 font-semibold">Digite a senha de People:</p>
              <input type="password" id="senhaAdmin" placeholder="Digite a senha" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg focus:outline-none focus:border-cyan-600 font-semibold mb-4">
              <div id="erroSenhaAdmin" class="text-red-600 text-sm font-bold mb-4 hidden">‚ö†Ô∏è Senha incorreta!</div>
              <div class="flex gap-3">
                <button onclick="document.getElementById('modais').innerHTML = ''" class="flex-1 px-4 py-2 bg-gray-400 text-white font-bold rounded-lg text-lg">Cancelar</button>
                <button onclick="app.confirmarSenhaAdmin()" class="flex-1 px-4 py-2 bg-blue-600 text-white font-bold rounded-lg text-lg">Confirmar</button>
              </div>
            </div>
          </div>
        `;
      }

      confirmarSenhaAdmin() {
        const senha = document.getElementById('senhaAdmin').value;
        const erroDiv = document.getElementById('erroSenhaAdmin');

        if (senha !== this.senhaRelatorio) {
          erroDiv.classList.remove('hidden');
          return;
        }

        // senha ok: fecha modal de senha e abre o formul√°rio de nova cartinha
        document.getElementById('modais').innerHTML = '';
        this.abrirModalNovaCarta();
      }

      // ---------- MODAIS ----------
      abrirModalNovaCarta() {
        const modaisDiv = document.getElementById('modais');
        modaisDiv.innerHTML = `
          <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full shadow-2xl border-2 border-cyan-400">
              <h2 class="text-2xl font-black text-blue-700 mb-4">Adicionar Nova Cartinha üéÅ</h2>
              <div class="space-y-4 mb-6">
                <input type="text" id="nomeCarta" placeholder="Nome da cartinha" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg focus:outline-none focus:border-cyan-600 font-semibold">
                <input type="text" id="idadeCarta" placeholder="Idade" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg focus:outline-none focus:border-cyan-600 font-semibold">
                <input type="text" id="desejoCarta" placeholder="O que deseja (opcional)" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg focus:outline-none focus:border-cyan-600 font-semibold">
                <input type="file" id="imagemCarta" accept="image/*" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg">
              </div>
              <div class="flex gap-3">
                <button onclick="document.getElementById('modais').innerHTML = ''" class="flex-1 px-4 py-2 bg-gray-400 text-white font-bold rounded-lg text-lg">Cancelar</button>
                <button onclick="app.confirmarNovaCarta()" class="flex-1 px-4 py-2 bg-blue-600 text-white font-bold rounded-lg text-lg">Adicionar</button>
              </div>
            </div>
          </div>
        `;
      }

      async confirmarNovaCarta() {
        const nome = document.getElementById('nomeCarta').value;
        const idade = document.getElementById('idadeCarta').value;
        const desejo = document.getElementById('desejoCarta').value;
        const imagemInput = document.getElementById('imagemCarta');
        const arquivo = imagemInput.files[0] || null;

        if (!nome.trim() || !idade.trim()) {
          alert('Preencha nome e idade!');
          return;
        }

        await this.adicionarCarta(nome, idade, desejo, arquivo);
        document.getElementById('modais').innerHTML = '';
      }

      abrirModalEscolha(cartaId) {
        const carta = this.cartas.find(c => c.id === cartaId);
        const modaisDiv = document.getElementById('modais');
        modaisDiv.innerHTML = `
          <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full shadow-2xl border-2 border-cyan-400">
              <h2 class="text-2xl font-black text-blue-700 mb-4">Escolher uma Cartinha üéÅ</h2>
              <div class="bg-gradient-to-br from-emerald-100 to-cyan-100 p-4 rounded-lg mb-6 text-center border-2 border-emerald-400">
                ${
                  carta.imagem
                    ? `<img src="${carta.imagem}" class="w-24 h-24 object-cover rounded-lg mx-auto mb-2">`
                    : '<p class="text-5xl mb-2">üòä</p>'
                }
                <p class="font-black text-lg text-blue-900">${carta.nome}</p>
                <p class="text-blue-800 font-bold">${carta.idade}</p>
                <p class="text-sm text-blue-700 mt-2 font-bold">Desejo: ${carta.desejo}</p>
              </div>
              <input type="email" id="emailEscolha" placeholder="seu.email@zappts.com.br" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg focus:outline-none focus:border-cyan-600 font-semibold mb-4">
              <div id="erroEmail" class="text-red-600 text-sm font-bold mb-4 hidden">‚ö†Ô∏è Email deve terminar com @zappts.com.br</div>
              <div class="flex gap-3">
                <button onclick="document.getElementById('modais').innerHTML = ''" class="flex-1 px-4 py-2 bg-gray-400 text-white font-bold rounded-lg text-lg">Cancelar</button>
                <button onclick="app.confirmarEscolha(${cartaId})" class="flex-1 px-4 py-2 bg-cyan-400 text-blue-900 font-bold rounded-lg text-lg">Confirmar</button>
              </div>
            </div>
          </div>
        `;
      }

      async confirmarEscolha(cartaId) {
        const email = document.getElementById('emailEscolha').value;
        const erroDiv = document.getElementById('erroEmail');

        if (!this.validarEmail(email)) {
          erroDiv.classList.remove('hidden');
          return;
        }

        await this.escolherCarta(cartaId, email);
        document.getElementById('modais').innerHTML = '';
      }

      abrirModalInfo() {
        const modaisDiv = document.getElementById('modais');
        modaisDiv.innerHTML = `
          <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-xl p-8 max-w-2xl w-full shadow-2xl border-2 border-cyan-400 max-h-96 overflow-y-auto">
              <h2 class="text-2xl font-black text-blue-700 mb-4">üìã Regras e Prazos</h2>
              <div class="space-y-4 text-gray-800 text-sm md:text-base">
                <div>
                  <h3 class="font-black text-blue-700 mb-2 text-lg">üéÖ‚ú® Natal Solid√°rio - Zappts 2025 ‚ú®</h3>
                  <p class="font-semibold">
                    Promover integra√ß√£o entre os Zappters e impactar positivamente a comunidade por meio de uma a√ß√£o solid√°ria, incentivando a doa√ß√£o de brinquedos
                    para crian√ßas em situa√ß√£o de vulnerabilidade social, com apoio financeiro da Zappts.
                  </p>
                </div>
                <div>
                  <h3 class="font-black text-blue-700 mb-2 text-lg">1. Descri√ß√£o da A√ß√£o</h3>
                  <p class="font-semibold">
                    A campanha visa engajar nossos colaboradores na doa√ß√£o de brinquedos para crian√ßas em situa√ß√£o de vulnerabilidade,
                    com foco no Instituto Eden Lar - S√£o Jos√© dos Campos, em parceria com o PIT - Parque de Inova√ß√£o Tecnol√≥gica.
                    Cada participante receber√° um voucher de R$ 50 como saldo livre no Caju, para compra do brinquedo.
                  </p>
                </div>
                <div>
                  <h3 class="font-black text-blue-700 mb-2 text-lg">2. Como funcionar√°?</h3>
                  <ul class="space-y-1 ml-4 font-semibold list-disc">
                    <li>Inscri√ß√µes at√© 02/12/2025, via formul√°rio interno.</li>
                    <li>Cada participante recebe um voucher de R$ 50 no saldo livre do Caju.</li>
                    <li>O brinquedo deve ser comprado online e enviado para o endere√ßo do PIT.</li>
                    <li>As crian√ßas s√£o escolhidas aqui na p√°gina, conforme as cartinhas cadastradas.</li>
                  </ul>
                </div>
                <div>
                  <h3 class="font-black text-blue-700 mb-2 text-lg">3. Prazos</h3>
                  <ul class="space-y-1 ml-4 font-semibold list-disc">
                    <li>Abertura das inscri√ß√µes: 27/11/2025</li>
                    <li>Prazo final para inscri√ß√£o: 02/12/2025</li>
                    <li>Distribui√ß√£o dos vouchers: 04/12/2025</li>
                    <li>Prazo para compra dos brinquedos: 08/12/2025</li>
                    <li>Entrega dos brinquedos ao Instituto Eden Lar: 11/12/2025</li>
                  </ul>
                </div>
                <div>
                  <h3 class="font-black text-blue-700 mb-2 text-lg">4. Compartilhamento</h3>
                  <p class="font-semibold">
                    Ap√≥s a compra, o Zappter participante deve postar no canal Espa√ßo Zappts, no Google Chat:
                  </p>
                  <ul class="space-y-1 ml-4 font-semibold list-disc">
                    <li>Imagem do brinquedo comprado.</li>
                    <li>Caracter√≠sticas da crian√ßa (quando dispon√≠veis) e brinquedo escolhido.</li>
                  </ul>
                </div>
              </div>
              <button onclick="document.getElementById('modais').innerHTML = ''" class="w-full mt-6 px-4 py-2 bg-blue-600 text-white font-bold rounded-lg text-lg">Entendi!</button>
            </div>
          </div>
        `;
      }

      abrirModalSenha() {
        const modaisDiv = document.getElementById('modais');
        modaisDiv.innerHTML = `
          <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full shadow-2xl border-2 border-cyan-400">
              <h2 class="text-2xl font-black text-blue-700 mb-4">üîí Acesso ao Relat√≥rio</h2>
              <p class="text-gray-700 mb-6 font-semibold">Digite a senha:</p>
              <input type="password" id="senhaInput" placeholder="Digite a senha" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg focus:outline-none focus:border-cyan-600 font-semibold mb-4">
              <div id="erroSenha" class="text-red-600 text-sm font-bold mb-4 hidden">‚ö†Ô∏è Senha incorreta!</div>
              <div class="flex gap-3">
                <button onclick="document.getElementById('modais').innerHTML = ''" class="flex-1 px-4 py-2 bg-gray-400 text-white font-bold rounded-lg text-lg">Cancelar</button>
                <button onclick="app.confirmarSenha()" class="flex-1 px-4 py-2 bg-green-600 text-white font-bold rounded-lg text-lg">Baixar</button>
              </div>
            </div>
          </div>
        `;
      }

      confirmarSenha() {
        const senha = document.getElementById('senhaInput').value;
        const erroDiv = document.getElementById('erroSenha');

        if (this.baixarRelatorio(senha)) {
          document.getElementById('modais').innerHTML = '';
        } else {
          erroDiv.classList.remove('hidden');
        }
      }

      abrirModalSenhaDelete() {
        const modaisDiv = document.getElementById('modais');
        modaisDiv.innerHTML = `
          <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full shadow-2xl border-2 border-cyan-400">
              <h2 class="text-2xl font-black text-blue-700 mb-4">üîí Excluir Cartinha</h2>
              <p class="text-gray-700 mb-6 font-semibold">Digite a senha para excluir:</p>
              <input type="password" id="senhaDelete" placeholder="Digite a senha" class="w-full px-4 py-2 border-2 border-cyan-300 rounded-lg focus:outline-none focus:border-cyan-600 font-semibold mb-4">
              <div id="erroSenhaDelete" class="text-red-600 text-sm font-bold mb-4 hidden">‚ö†Ô∏è Senha incorreta!</div>
              <div class="flex gap-3">
                <button onclick="document.getElementById('modais').innerHTML = ''" class="flex-1 px-4 py-2 bg-gray-400 text-white font-bold rounded-lg text-lg">Cancelar</button>
                <button onclick="app.confirmarDelete()" class="flex-1 px-4 py-2 bg-red-600 text-white font-bold rounded-lg text-lg">Excluir</button>
              </div>
            </div>
          </div>
        `;
      }

      ampliarImagem(src) {
        const modaisDiv = document.getElementById('modais');
        modaisDiv.innerHTML = `
          <div class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center p-4 z-50">
            <div class="relative">
              <button onclick="document.getElementById('modais').innerHTML = ''" class="absolute -top-12 right-0 text-white hover:text-gray-300 text-3xl">‚úï</button>
              <img src="${src}" class="rounded-xl shadow-2xl max-w-full max-h-96 object-contain">
            </div>
          </div>
        `;
      }
    }

    // Inicializa quando a p√°gina carrega
    window.addEventListener('load', () => {
      new NatalSolidario();
    });
  </script>
</body>
</html>
